![lint](https://github.com/CEBEP9HUH/OTUS_Go_Diploma/actions/workflows/diploma.yml/badge.svg)
# Демон системного мониторинга

Выполненные пункты ТЗ:
* Реализован сбор:
    - load average
    - загрузка CPU
    - загрузка дисков
* Через конфигурацию можно отключать отдельную статистику
* Написаны юнит-тесты
* Реализован простой клиент к демону

# Сборка

Сборка всего проекта выполняется командой
```
make all
```
> [!NOTE]
> Артефакты сборки будут помещены в папку artifacts в корне проекта

Также можно выполнить сборку только клиента
```
make client
```
или только сервера 
```
make server
```
> [!IMPORTANT]
> Сборка только сервера не копирует файл конфигурации в папку с расположением артифактов

# Запуск
## Запуск клиента
Запуск клиента выполняется командой
```
client
```
Параметры запуска
|параметр|тип|описание|значение по умолчанию|обязательный|
|---|---|---|---|---|
|addr|string|адрес для подключения к серверу статистики|localhost:5678|нет|
|collect|duration|время накопления данных для статистики|2s|нет|
|interval|duration|период отправки статистики|10s|нет|
|print|uint|выбор статистики для печати<br>0 - cpu<br>1 - io<br>2 - load<br>3 - disk<br>4 - node|0 - cpu|нет|

Пример запуска с параметрами
```
client -addr="localhost:1234" -collect=10s -interval=2s -print=0
```

## Запуск сервера
Запуск сервера выполняется командой
```
server
```
> [!IMPORTANT]
> Сервер ищет файл конфигурации в директории где расположен исполняемый файл. Файл конфигурации должен лежать в одной директории с ним и называться "config.json"

Параметры запуска
|параметр|тип|описание|значение по умолчанию|обязательный|
|---|---|---|---|---|
|port|uint|порт, на котором сервер ожидает подключения|5678|нет|

### Конфигурация сервера
Работа сервера настраивается с помощью файла "config.json".
Содержание файла:
```
{
    "sysStatDaemon": {
        "logLevel": "info",
        "periodSec": 1,
        "collectors": {
            "enableLoadAvg": true,
            "enableCpuUsage": true,
            "enableDiskUsage" : true,
            "enableNodeUsage" : true,
            "enableIoStat" : true
        }
    }
}
```
Описание файла конфигурации
|параметр|тип|описание|значение по умолчанию|обязательный|
|---|---|---|---|---|
|logLevel|string|уровень логирования<br>варианты: debug, info, warn, error|-|да|
|periodSec|uint|период сбора статистики|-|да|
|collectors.enableLoadAvg|bool|включить сбор информации о средней загрузке системы|-|да|
|collectors.enableCpuUsage|bool|включить сбор информации о загрузке CPU|-|да|
|collectors.enableDiskUsage|bool|включить сбор информации об использовании дисков|-|да|
|collectors.enableNodeUsage|bool|включить сбор информации об использовании нод|-|да|
|collectors.enableIoStat|bool|включить сбор информации об операциях чтения/записи|-|да|
